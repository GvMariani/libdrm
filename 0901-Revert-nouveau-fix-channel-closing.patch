From a96d6182cdb35f2d155391bc179319d8f682f16c Mon Sep 17 00:00:00 2001
From: Colin Guthrie <colin@mageia.org>
Date: Sat, 30 Jun 2012 17:56:43 +0100
Subject: [PATCH 901/905] Revert "nouveau: fix channel closing"

This reverts commit 5288729823ee1c243023758c35fbe8e3a70ccf9c.
---
 nouveau/nouveau.c | 17 +++++------------
 1 file changed, 5 insertions(+), 12 deletions(-)

diff --git a/nouveau/nouveau.c b/nouveau/nouveau.c
index 5aa4107..f0bc2c3 100644
--- a/nouveau/nouveau.c
+++ b/nouveau/nouveau.c
@@ -278,22 +278,15 @@ nouveau_object_new(struct nouveau_object *parent, uint64_t handle,
 void
 nouveau_object_del(struct nouveau_object **pobj)
 {
+	struct drm_nouveau_gpuobj_free req;
 	struct nouveau_object *obj = *pobj;
 	struct nouveau_device *dev;
 	if (obj) {
 		dev = nouveau_object_find(obj, NOUVEAU_DEVICE_CLASS);
-		if (obj->oclass == NOUVEAU_FIFO_CHANNEL_CLASS) {
-			struct drm_nouveau_channel_free req;
-			req.channel = obj->handle;
-			drmCommandWrite(dev->fd, DRM_NOUVEAU_CHANNEL_FREE,
-					&req, sizeof(req));
-		} else {
-			struct drm_nouveau_gpuobj_free req;
-			req.channel = obj->parent->handle;
-			req.handle  = obj->handle;
-			drmCommandWrite(dev->fd, DRM_NOUVEAU_GPUOBJ_FREE,
-					&req, sizeof(req));
-		}
+		req.channel = obj->parent->handle;
+		req.handle  = obj->handle;
+		drmCommandWrite(dev->fd, DRM_NOUVEAU_GPUOBJ_FREE,
+				&req, sizeof(req));
 	}
 	free(obj);
 	*pobj = NULL;
-- 
1.7.11

